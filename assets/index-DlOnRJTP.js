(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const p of o.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&r(p)}).observe(document,{childList:!0,subtree:!0});function i(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=i(n);fetch(n.href,o)}})();const ie={type:Phaser.AUTO,width:window.innerWidth,height:window.innerHeight,parent:"game-container",scale:{mode:Phaser.Scale.RESIZE,autoCenter:Phaser.Scale.CENTER_BOTH},scene:{preload:ae,create:re,update:oe},physics:{default:"arcade",arcade:{gravity:{y:0}}}};let C,a,m,S,b,D,l,M,T,P,x,v,B,y=0,h=1,d,K,t,R=0,Y=0,F=0,X=0,V=!1;const ne=document.getElementById("start-screen"),q=document.getElementById("instructions-screen"),I=document.getElementById("orientationOverlay");j()?(L(),window.addEventListener("resize",L),window.addEventListener("orientationchange",L)):I.style.display="none";document.getElementById("sentinelMode").addEventListener("click",()=>_("sentinel"));document.getElementById("dogeMode").addEventListener("click",()=>_("doge"));function _(e){a=e,ne.style.display="none",q.style.display="flex",q.style.backgroundImage=a==="sentinel"?"url('/assets/sentinel-bg.png')":"url('/assets/doge-bg.png')",document.getElementById("instructions-text").textContent=a==="sentinel"?"You’re a loyal agent protecting a vital cause! Drag field logs, briefs, and ledgers to the shredder before auditors strike. Drag decoy reports (green) to the printer to mislead them. Fail, and it’s Audit Bust!":"You’re a whistleblower fighting to expose corruption! Drag expense reports, emails, and ledgers to the scanner to build your case. Drag testimony (green) to the printer to gain support. Fail, and trust is lost!",document.getElementById("startButton").onclick=()=>{q.style.display="none",C=new Phaser.Game(ie),document.querySelector("canvas").style.display="block",V=!0,L()}}function ae(){this.load.image("sentinel-bg","/assets/sentinel-bg.png"),this.load.image("doge-bg","/assets/doge-bg.png"),this.load.image("summary-bg","/assets/summary-bg.png"),this.load.image("field-expense-logs","/assets/field-expense-logs.png"),this.load.image("operation-briefs","/assets/operation-briefs.png"),this.load.image("project-ledgers","/assets/project-ledgers.png"),this.load.image("decoy-reports","/assets/decoy-reports.png"),this.load.image("expense-reports","/assets/expense-reports.png"),this.load.image("emails","/assets/emails.png"),this.load.image("ledgers","/assets/ledgers.png"),this.load.image("testimony","/assets/testimony.png"),this.load.image("shredder","/assets/shredder.png"),this.load.image("scanner","/assets/scanner.png"),this.load.image("printer","/assets/printer.png"),this.load.image("paper-airplane","/assets/paper-airplane.png"),this.load.audio("shred","/assets/shred.mp3"),this.load.audio("scan","/assets/scan.mp3"),this.load.audio("print","/assets/print.mp3")}function re(){t=Math.min(this.scale.width/1920,this.scale.height/1080),d=a==="sentinel"?0:100,y=0,h=1,R=0,Y=0,F=0,X=0,B=this.add.image(0,0,a==="sentinel"?"sentinel-bg":"doge-bg").setOrigin(0,0).setDisplaySize(this.scale.width,this.scale.height).setDepth(0),v=this.add.rectangle(this.scale.width/2,65*t,this.scale.width,130*t,0,.8).setOrigin(.5,.5).setDepth(1),S=this.add.image(this.scale.width/2,this.scale.height-100*t,"shredder").setInteractive().setScale(t*1.5).setDepth(2),b=this.add.image(this.scale.width/2,this.scale.height-100*t,"scanner").setInteractive().setScale(t*1.2).setDepth(2),D=this.add.image(this.scale.width-190*t,this.scale.height-120*t,"printer").setInteractive().setScale(t*1.3).setDepth(2),S.visible=a==="sentinel",b.visible=a==="doge",D.visible=!0;const e=this.scale.width/2-100*t;M=this.add.rectangle(this.scale.width/2,90*t,e,20*t).setStrokeStyle(2,16777215).setOrigin(.5,0).setDepth(2),l=this.add.rectangle((this.scale.width-e)/2,90*t,e,20*t,65280).setOrigin(0,0).setDepth(2),T=this.add.text(this.scale.width/2,20*t,a==="sentinel"?"Auditor's Suspicion":"Public Trust",{fontSize:`${20*Math.max(t,.7)}px`,color:"#fff",align:"center"}).setOrigin(.5,0).setDepth(2),A(this,0),P=this.add.text(this.scale.width-50*t,20*t,`Score: ${y}`,{fontSize:`${20*Math.max(t,.7)}px`,color:"#fff",align:"right"}).setOrigin(1,0).setDepth(2),x=this.add.text(this.scale.width-50*t,90*t,`x${h}`,{fontSize:`${20*Math.max(t,.7)}px`,color:"#fff",align:"right"}).setOrigin(1,0).setDepth(2),m=this.physics.add.group({depth:10}),this.input.on("drag",(s,i,r,n)=>{const o=50*t,p=this.scale.width-50*t,$=50*t,c=this.scale.height-50*t;i.x=Phaser.Math.Clamp(r,o,p),i.y=Phaser.Math.Clamp(n,$,c),i.timerCircle&&(i.timerCircle.x=i.x,i.timerCircle.y=i.y-60*t)}),this.input.on("dragend",(s,i)=>de(this,s,i)),K=this.time.addEvent({delay:800,callback:ce,callbackScope:this,loop:!0}),this.time.addEvent({delay:1e3,callback:ge,callbackScope:this,loop:!0}),this.scale.on("resize",me,this)}function oe(){if(!V||!m||!m.children)return;const e=[];m.children.each(s=>{s&&s.timer!==void 0&&(s.timer-=this.game.loop.delta/1e3,pe(s),s.timer<=0&&e.push(s))}),e.forEach(s=>{if(s.timerCircle&&s.timerCircle.destroy(),!s.getData("isBeneficial")){let i;switch(s.texture.key){case(a==="sentinel"?"field-expense-logs":"expense-reports"):i=a==="sentinel"?1:-1;break;case(a==="sentinel"?"operation-briefs":"emails"):i=a==="sentinel"?10:-10;break;case(a==="sentinel"?"project-ledgers":"ledgers"):i=a==="sentinel"?20:-20;break}A(this,i)}h=1,x.setText(`x${h}`),m.remove(s,!0,!0)})}function Q(e,s){e.tweens.add({targets:s,angle:{from:-2,to:2},duration:100,yoyo:!0,repeat:2,ease:"Sine.easeInOut",onComplete:()=>{s.angle=0}})}function Z(e,s,i){e.tweens.add({targets:s,scale:{from:s.scale*1.5,to:0},alpha:{from:1,to:0},y:i.y,duration:300,ease:"Power2",onComplete:()=>{s.timerCircle&&s.timerCircle.destroy(),m.remove(s,!0,!0)}})}function le(e,s,i){const r=e.add.sprite(s.x,s.y,"paper-airplane").setScale(t*2).setDepth(3),n=i.width*i.scaleX,o=i.x+n;e.tweens.add({targets:r,x:o,y:i.y+i.height*t/2,scale:t*.4,duration:750,ease:"Quad.easeOut",onUpdate:p=>{r.angle=Math.sin(p.progress*Math.PI)*10},onComplete:()=>{e.tweens.add({targets:i,scaleY:1.2*t,duration:100,yoyo:!0,onComplete:()=>{r.destroy()}})}})}function de(e,s,i){if(!i||i.timer===void 0||i.timer<=0)return;const r=a==="sentinel"?S:b,n=D;i.getData("isBeneficial")?Phaser.Geom.Intersects.RectangleToRectangle(i.getBounds(),n.getBounds())&&(Z(e,i,n),Q(e,n),e.sound.play("print"),y+=i.getData("points")*h,P.setText(`Score: ${y}`),A(e,a==="sentinel"?-25:25),le(e,n,l),h=Math.min(h+1,5),x.setText(`x${h}`),X++):Phaser.Geom.Intersects.RectangleToRectangle(i.getBounds(),r.getBounds())&&(Z(e,i,r),Q(e,r),a==="sentinel"?e.sound.play("shred"):e.sound.play("scan"),y+=i.getData("points")*h,P.setText(`Score: ${y}`),A(e,0),h=Math.min(h+1,5),x.setText(`x${h}`),i.texture.key===(a==="sentinel"?"field-expense-logs":"expense-reports")?R++:i.texture.key===(a==="sentinel"?"operation-briefs":"emails")?Y++:i.texture.key===(a==="sentinel"?"project-ledgers":"ledgers")&&F++)}function ce(){const e=100*t,s=this.scale.width-100*t,i=150*t,r=this.scale.height/2,n=Phaser.Math.Between(e,s),o=Phaser.Math.Between(i,r),p=a==="sentinel"?[{key:"field-expense-logs",points:10,meterChange:1,weight:50},{key:"operation-briefs",points:20,meterChange:10,weight:30},{key:"project-ledgers",points:50,meterChange:20,weight:20}]:[{key:"expense-reports",points:10,meterChange:1,weight:50},{key:"emails",points:20,meterChange:10,weight:30},{key:"ledgers",points:50,meterChange:20,weight:20}],$=a==="sentinel"&&d>30||a==="doge"&&d<70;let c=[...p];$&&c.push({key:a==="sentinel"?"decoy-reports":"testimony",points:100,meterChange:25,weight:10});const G=c.reduce((w,N)=>w+N.weight,0);let O=Math.random()*G,u;for(const w of c)if(O-=w.weight,O<=0){u=w;break}const g=m.create(n,o,u.key).setInteractive({draggable:!0}).setScale(t*1.8).setDepth(10).setData("points",u.points).setData("meterChange",u.meterChange).setData("isBeneficial",u.key==="decoy-reports"||u.key==="testimony");this.tweens.add({targets:g,scale:t*1.5,duration:200,ease:"Back.easeOut"}),g.timer=3,g.timerCircle=he(this,g.x,g.y-60*t),g.originalX=g.x,g.originalY=g.y}function he(e,s,i){return e.add.graphics({x:s,y:i}).setDepth(10)}function pe(e){if(!e||!e.timerCircle)return;const s=e.timer/3;e.timerCircle.clear(),e.timerCircle.lineStyle(8*t,16777215),e.timerCircle.beginPath(),e.timerCircle.arc(0,0,20*t,-Math.PI/2,2*Math.PI*s-Math.PI/2,!1),e.timerCircle.strokePath()}function A(e,s=0){d=d+s,d=Phaser.Math.Clamp(d,0,100),l&&(l.scaleX=d/100),a==="sentinel"?d<=25?l.fillColor=65280:d<=50?l.fillColor=16776960:d<=75?l.fillColor=16753920:l.fillColor=16711680:d>75?l.fillColor=65280:d>50?l.fillColor=16776960:d>25?l.fillColor=16753920:l.fillColor=16711680,d===(a==="sentinel"?100:0)&&fe(e)}function ge(e){K.delay=Math.max(K.delay-8,300)}function fe(e){e.time.removeAllEvents(),m.children.each(f=>{f&&f.timerCircle&&f.timerCircle.destroy(),f&&m.remove(f,!0,!0)}),m.clear(!0),B&&B.destroy(),v&&v.destroy(),S&&S.destroy(),b&&b.destroy(),D&&D.destroy(),M&&M.destroy(),l&&l.destroy(),T&&T.destroy(),P&&P.destroy(),x&&x.destroy(),e.children.list.forEach(f=>f.destroy()),e.add.image(0,0,"summary-bg").setOrigin(0,0).setDisplaySize(e.scale.width,e.scale.height).setDepth(0),e.add.rectangle(e.scale.width/2,e.scale.height/2,e.scale.width,e.scale.height*.6,0,.8).setOrigin(.5,.5).setDepth(1);const s=a==="sentinel"?"Shredded":"Scanned",i=a==="sentinel"?"Decoy Reports":"Testimonies",r=Math.min(e.scale.width/20,e.scale.height/30),n=e.scale.height/20,o=e.scale.height*.6,p=(e.scale.height-o)/2,$=7*r+10*n,c=p+(o-$)/2;e.add.text(e.scale.width/2,c,`${a==="sentinel"?"Audit Bust!":"Trust Lost!"}`,{fontSize:`${r*1.5}px`,fontStyle:"bold",color:"#fff",align:"center"}).setOrigin(.5).setDepth(2);const G=e.add.text(e.scale.width/2,c+2*n,`${s} ${a==="sentinel"?"Field Expense Logs":"Expense Reports"}: 0 (0 pts)`,{fontSize:`${r}px`,color:"#fff",align:"center"}).setOrigin(.5).setDepth(2),O=e.add.text(e.scale.width/2,c+3*n,`${s} ${a==="sentinel"?"Operation Briefs":"Emails"}: 0 (0 pts)`,{fontSize:`${r}px`,color:"#fff",align:"center"}).setOrigin(.5).setDepth(2),u=e.add.text(e.scale.width/2,c+4*n,`${s} ${a==="sentinel"?"Project Ledgers":"Ledgers"}: 0 (0 pts)`,{fontSize:`${r}px`,color:"#fff",align:"center"}).setOrigin(.5).setDepth(2),g=e.add.text(e.scale.width/2,c+5*n,`Printed ${i}: 0 (0 pts)`,{fontSize:`${r}px`,color:"#fff",align:"center"}).setOrigin(.5).setDepth(2),w=e.add.text(e.scale.width/2,c+7*n,"Base Total: 0 pts",{fontSize:`${r}px`,color:"#fff",align:"center"}).setOrigin(.5).setDepth(2),N=e.add.text(e.scale.width/2,c+9*n,`Multiplier Bonus: ${y-(R*10+Y*20+F*50+X*100)} pts`,{fontSize:`${r}px`,color:"#fff",align:"center"}).setOrigin(.5).setVisible(!1).setDepth(2),J=e.add.text(e.scale.width/2,c+11*n,`Final Score: ${y}`,{fontSize:`${r*1.3}px`,fontStyle:"bold",color:"#fff",align:"center"}).setOrigin(.5).setVisible(!1).setDepth(2);let W=0;function E(f,H,ee,te,k){if(H===0){k&&k(0);return}let U=0,z=0;e.tweens.addCounter({from:0,to:H,duration:Math.min(H*200,te),onUpdate:se=>{U=Math.floor(se.getValue()),z=U*ee,f.setText(`${f.text.split(":")[0]}: ${U} (${z} pts)`),w.setText(`Base Total: ${W+z} pts`)},onComplete:()=>{W+=z,w.setText(`Base Total: ${W} pts`),k&&k()}})}E(G,R,10,3e3,()=>{E(O,Y,20,3e3,()=>{E(u,F,50,3e3,()=>{E(g,X,100,3e3,()=>{e.time.delayedCall(1e3,()=>{N.setVisible(!0),e.time.delayedCall(1e3,()=>{J.setVisible(!0)})})})})})}),V=!1}function j(){return/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)}function L(){if(!j()){I.style.display="none";return}window.matchMedia("(orientation: portrait)").matches?(I.style.display="flex",C&&C.scene&&C.scene.pause("default")):(I.style.display="none",V&&C&&C.scene&&C.scene.resume("default"))}function me(e){const s=e.width,i=e.height;t=Math.min(s/1920,i/1080),B&&B.setDisplaySize(s,i),v&&v.setPosition(s/2,65*t).setSize(s,130*t),S&&S.setPosition(s/2,i-100*t).setScale(t*1.5),b&&b.setPosition(s/2,i-100*t).setScale(t*1.5),D&&D.setPosition(s-100*t,i-100*t).setScale(t*1.5);const r=s/2-100*t;M&&M.setPosition(s/2,90*t).setSize(r,20*t),l&&l.setPosition((s-r)/2,90*t).setSize(r,20*t),T&&T.setPosition(s/2,20*t).setStyle({fontSize:`${20*Math.max(t,.7)}px`}),P&&P.setPosition(s-50*t,20*t).setStyle({fontSize:`${20*Math.max(t,.7)}px`}),x&&x.setPosition(s-50*t,90*t).setStyle({fontSize:`${20*Math.max(t,.7)}px`})}
