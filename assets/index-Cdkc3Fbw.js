(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const m of o.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}})();const te={type:Phaser.AUTO,width:window.innerWidth,height:window.innerHeight,parent:"game-container",scale:{mode:Phaser.Scale.RESIZE,autoCenter:Phaser.Scale.CENTER_BOTH},scene:{preload:se,create:ne,update:re},physics:{default:"arcade",arcade:{gravity:{y:0}}}};let S,n,g,b,C,D,d,T,v,P,x,M,B,y=0,h=1,l,K,t,R=0,F=0,Y=0,A=0,X=!1;const ie=document.getElementById("start-screen"),U=document.getElementById("instructions-screen"),L=document.getElementById("orientationOverlay");_()?(I(),window.addEventListener("resize",I),window.addEventListener("orientationchange",I)):L.style.display="none";document.getElementById("sentinelMode").addEventListener("click",()=>Z("sentinel"));document.getElementById("dogeMode").addEventListener("click",()=>Z("doge"));function Z(e){n=e,ie.style.display="none",U.style.display="flex",U.style.backgroundImage=n==="sentinel"?"url('/assets/sentinel-bg.png')":"url('/assets/doge-bg.png')",document.getElementById("instructions-text").textContent=n==="sentinel"?"You’re a loyal agent protecting a vital cause! Drag field logs, briefs, and ledgers to the shredder before auditors strike. Drag decoy reports (green) to the printer to mislead them. Fail, and it’s Audit Bust!":"You’re a whistleblower fighting to expose corruption! Drag expense reports, emails, and ledgers to the scanner to build your case. Drag testimony (green) to the printer to gain support. Fail, and trust is lost!",document.getElementById("startButton").onclick=()=>{U.style.display="none",S=new Phaser.Game(te),document.querySelector("canvas").style.display="block",X=!0,I()}}function se(){this.load.image("sentinel-bg","/assets/sentinel-bg.png"),this.load.image("doge-bg","/assets/doge-bg.png"),this.load.image("summary-bg","/assets/summary-bg.png"),this.load.image("field-expense-logs","/assets/field-expense-logs.png"),this.load.image("operation-briefs","/assets/operation-briefs.png"),this.load.image("project-ledgers","/assets/project-ledgers.png"),this.load.image("decoy-reports","/assets/decoy-reports.png"),this.load.image("expense-reports","/assets/expense-reports.png"),this.load.image("emails","/assets/emails.png"),this.load.image("ledgers","/assets/ledgers.png"),this.load.image("testimony","/assets/testimony.png"),this.load.image("shredder","/assets/shredder.png"),this.load.image("scanner","/assets/scanner.png"),this.load.image("printer","/assets/printer.png"),this.load.on("filecomplete",e=>console.log(`Loaded ${e}`)),this.load.on("loaderror",e=>console.error(`Failed to load ${e.key}`))}function ne(){t=Math.min(this.scale.width/1920,this.scale.height/1080),l=n==="sentinel"?0:100,y=0,h=1,R=0,F=0,Y=0,A=0,B=this.add.image(0,0,n==="sentinel"?"sentinel-bg":"doge-bg").setOrigin(0,0).setDisplaySize(this.scale.width,this.scale.height).setDepth(0),M=this.add.rectangle(this.scale.width/2,65*t,this.scale.width,130*t,0,.8).setOrigin(.5,.5).setDepth(1),b=this.add.image(this.scale.width/2,this.scale.height-100*t,"shredder").setInteractive().setScale(t*1.5).setDepth(2),C=this.add.image(this.scale.width/2,this.scale.height-100*t,"scanner").setInteractive().setScale(t*1.2).setDepth(2),D=this.add.image(this.scale.width-190*t,this.scale.height-120*t,"printer").setInteractive().setScale(t*1.3).setDepth(2),b.visible=n==="sentinel",C.visible=n==="doge",D.visible=!0;const e=this.scale.width/2-100*t;T=this.add.rectangle(this.scale.width/2,90*t,e,20*t).setStrokeStyle(2,16777215).setOrigin(.5,0).setDepth(2),d=this.add.rectangle((this.scale.width-e)/2,90*t,e,20*t,65280).setOrigin(0,0).setDepth(2),v=this.add.text(this.scale.width/2,20*t,n==="sentinel"?"Auditor's Suspicion":"Public Trust",{fontSize:`${20*Math.max(t,.7)}px`,color:"#fff",align:"center"}).setOrigin(.5,0).setDepth(2),V(this,0),P=this.add.text(this.scale.width-50*t,20*t,`Score: ${y}`,{fontSize:`${20*Math.max(t,.7)}px`,color:"#fff",align:"right"}).setOrigin(1,0).setDepth(2),x=this.add.text(this.scale.width-50*t,90*t,`x${h}`,{fontSize:`${20*Math.max(t,.7)}px`,color:"#fff",align:"right"}).setOrigin(1,0).setDepth(2),g=this.physics.add.group({depth:10}),this.input.on("drag",(i,s,a,r)=>{const o=50*t,m=this.scale.width-50*t,$=50*t,c=this.scale.height-50*t;s.x=Phaser.Math.Clamp(a,o,m),s.y=Phaser.Math.Clamp(r,$,c),s.timerCircle&&(s.timerCircle.x=s.x,s.timerCircle.y=s.y-60*t)}),this.input.on("dragend",(i,s)=>ae(this,i,s)),K=this.time.addEvent({delay:800,callback:oe,callbackScope:this,loop:!0}),this.time.addEvent({delay:1e3,callback:ce,callbackScope:this,loop:!0}),this.scale.on("resize",ge,this)}function re(){if(!X||!g||!g.children)return;const e=[];g.children.each(i=>{i&&i.timer!==void 0&&(i.timer-=this.game.loop.delta/1e3,de(i),i.timer<=0&&e.push(i))}),e.forEach(i=>{if(i.timerCircle&&i.timerCircle.destroy(),!i.getData("isBeneficial")){let s;switch(i.texture.key){case(n==="sentinel"?"field-expense-logs":"expense-reports"):s=n==="sentinel"?1:-1;break;case(n==="sentinel"?"operation-briefs":"emails"):s=n==="sentinel"?10:-10;break;case(n==="sentinel"?"project-ledgers":"ledgers"):s=n==="sentinel"?20:-20;break}V(this,s)}h=1,x.setText(`x${h}`),g.remove(i,!0,!0)})}function ae(e,i,s){if(!s||s.timer===void 0||s.timer<=0)return;const a=n==="sentinel"?b:C,r=D;s.getData("isBeneficial")?Phaser.Geom.Intersects.RectangleToRectangle(s.getBounds(),r.getBounds())&&(s.timerCircle.destroy(),s.timer=void 0,y+=s.getData("points")*h,P.setText(`Score: ${y}`),V(e,n==="sentinel"?-25:25),h=Math.min(h+1,5),x.setText(`x${h}`),A++,g.remove(s,!0,!0)):Phaser.Geom.Intersects.RectangleToRectangle(s.getBounds(),a.getBounds())&&(s.timerCircle.destroy(),s.timer=void 0,y+=s.getData("points")*h,P.setText(`Score: ${y}`),V(e,0),h=Math.min(h+1,5),x.setText(`x${h}`),s.texture.key===(n==="sentinel"?"field-expense-logs":"expense-reports")?R++:s.texture.key===(n==="sentinel"?"operation-briefs":"emails")?F++:s.texture.key===(n==="sentinel"?"project-ledgers":"ledgers")&&Y++,g.remove(s,!0,!0))}function oe(){const e=100*t,i=this.scale.width-100*t,s=150*t,a=this.scale.height/2,r=Phaser.Math.Between(e,i),o=Phaser.Math.Between(s,a),m=n==="sentinel"?[{key:"field-expense-logs",points:10,meterChange:1,weight:50},{key:"operation-briefs",points:20,meterChange:10,weight:30},{key:"project-ledgers",points:50,meterChange:20,weight:20}]:[{key:"expense-reports",points:10,meterChange:1,weight:50},{key:"emails",points:20,meterChange:10,weight:30},{key:"ledgers",points:50,meterChange:20,weight:20}],$=n==="sentinel"&&l>30||n==="doge"&&l<70;let c=[...m];$&&c.push({key:n==="sentinel"?"decoy-reports":"testimony",points:100,meterChange:25,weight:10});const G=c.reduce((w,N)=>w+N.weight,0);let E=Math.random()*G,u;for(const w of c)if(E-=w.weight,E<=0){u=w;break}const f=g.create(r,o,u.key).setInteractive({draggable:!0}).setScale(t*1.5).setDepth(10).setData("points",u.points).setData("meterChange",u.meterChange).setData("isBeneficial",u.key==="decoy-reports"||u.key==="testimony");f.timer=3,f.timerCircle=le(this,f.x,f.y-60*t),f.originalX=f.x,f.originalY=f.y}function le(e,i,s){return e.add.graphics({x:i,y:s}).setDepth(10)}function de(e){if(!e||!e.timerCircle)return;const i=e.timer/3;e.timerCircle.clear(),e.timerCircle.lineStyle(8*t,16777215),e.timerCircle.beginPath(),e.timerCircle.arc(0,0,20*t,-Math.PI/2,2*Math.PI*i-Math.PI/2,!1),e.timerCircle.strokePath()}function V(e,i=0){l=l+i,l=Phaser.Math.Clamp(l,0,100),d&&(d.scaleX=l/100),n==="sentinel"?l<=25?d.fillColor=65280:l<=50?d.fillColor=16776960:l<=75?d.fillColor=16753920:d.fillColor=16711680:l>75?d.fillColor=65280:l>50?d.fillColor=16776960:l>25?d.fillColor=16753920:d.fillColor=16711680,l===(n==="sentinel"?100:0)&&he(e)}function ce(e){K.delay=Math.max(K.delay-8,300)}function he(e){e.time.removeAllEvents(),g.children.each(p=>{p&&p.timerCircle&&p.timerCircle.destroy(),p&&g.remove(p,!0,!0)}),g.clear(!0),B&&B.destroy(),M&&M.destroy(),b&&b.destroy(),C&&C.destroy(),D&&D.destroy(),T&&T.destroy(),d&&d.destroy(),v&&v.destroy(),P&&P.destroy(),x&&x.destroy(),e.children.list.forEach(p=>p.destroy()),e.add.image(0,0,"summary-bg").setOrigin(0,0).setDisplaySize(e.scale.width,e.scale.height).setDepth(0),e.add.rectangle(e.scale.width/2,e.scale.height/2,e.scale.width,e.scale.height*.6,0,.8).setOrigin(.5,.5).setDepth(1);const i=n==="sentinel"?"Shredded":"Scanned",s=n==="sentinel"?"Decoy Reports":"Testimonies",a=Math.min(e.scale.width/20,e.scale.height/30),r=e.scale.height/20,o=e.scale.height*.6,m=(e.scale.height-o)/2,$=7*a+10*r,c=m+(o-$)/2;e.add.text(e.scale.width/2,c,`${n==="sentinel"?"Audit Bust!":"Trust Lost!"}`,{fontSize:`${a*1.5}px`,fontStyle:"bold",color:"#fff",align:"center"}).setOrigin(.5).setDepth(2);const G=e.add.text(e.scale.width/2,c+2*r,`${i} ${n==="sentinel"?"Field Expense Logs":"Expense Reports"}: 0 (0 pts)`,{fontSize:`${a}px`,color:"#fff",align:"center"}).setOrigin(.5).setDepth(2),E=e.add.text(e.scale.width/2,c+3*r,`${i} ${n==="sentinel"?"Operation Briefs":"Emails"}: 0 (0 pts)`,{fontSize:`${a}px`,color:"#fff",align:"center"}).setOrigin(.5).setDepth(2),u=e.add.text(e.scale.width/2,c+4*r,`${i} ${n==="sentinel"?"Project Ledgers":"Ledgers"}: 0 (0 pts)`,{fontSize:`${a}px`,color:"#fff",align:"center"}).setOrigin(.5).setDepth(2),f=e.add.text(e.scale.width/2,c+5*r,`Printed ${s}: 0 (0 pts)`,{fontSize:`${a}px`,color:"#fff",align:"center"}).setOrigin(.5).setDepth(2),w=e.add.text(e.scale.width/2,c+7*r,"Base Total: 0 pts",{fontSize:`${a}px`,color:"#fff",align:"center"}).setOrigin(.5).setDepth(2),N=e.add.text(e.scale.width/2,c+9*r,`Multiplier Bonus: ${y-(R*10+F*20+Y*50+A*100)} pts`,{fontSize:`${a}px`,color:"#fff",align:"center"}).setOrigin(.5).setVisible(!1).setDepth(2),j=e.add.text(e.scale.width/2,c+11*r,`Final Score: ${y}`,{fontSize:`${a*1.3}px`,fontStyle:"bold",color:"#fff",align:"center"}).setOrigin(.5).setVisible(!1).setDepth(2);let H=0;function k(p,W,J,Q,O){if(W===0){O&&O(0);return}let q=0,z=0;e.tweens.addCounter({from:0,to:W,duration:Math.min(W*200,Q),onUpdate:ee=>{q=Math.floor(ee.getValue()),z=q*J,p.setText(`${p.text.split(":")[0]}: ${q} (${z} pts)`),w.setText(`Base Total: ${H+z} pts`)},onComplete:()=>{H+=z,w.setText(`Base Total: ${H} pts`),O&&O()}})}k(G,R,10,3e3,()=>{k(E,F,20,3e3,()=>{k(u,Y,50,3e3,()=>{k(f,A,100,3e3,()=>{e.time.delayedCall(1e3,()=>{N.setVisible(!0),e.time.delayedCall(1e3,()=>{j.setVisible(!0)})})})})})}),X=!1}function _(){return/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)}function I(){if(!_()){L.style.display="none";return}window.matchMedia("(orientation: portrait)").matches?(L.style.display="flex",S&&S.scene&&S.scene.pause("default")):(L.style.display="none",X&&S&&S.scene&&S.scene.resume("default"))}function ge(e){const i=e.width,s=e.height;t=Math.min(i/1920,s/1080),B&&B.setDisplaySize(i,s),M&&M.setPosition(i/2,65*t).setSize(i,130*t),b&&b.setPosition(i/2,s-100*t).setScale(t*1.5),C&&C.setPosition(i/2,s-100*t).setScale(t*1.5),D&&D.setPosition(i-100*t,s-100*t).setScale(t*1.5);const a=i/2-100*t;T&&T.setPosition(i/2,90*t).setSize(a,20*t),d&&d.setPosition((i-a)/2,90*t).setSize(a,20*t),v&&v.setPosition(i/2,20*t).setStyle({fontSize:`${20*Math.max(t,.7)}px`}),P&&P.setPosition(i-50*t,20*t).setStyle({fontSize:`${20*Math.max(t,.7)}px`}),x&&x.setPosition(i-50*t,90*t).setStyle({fontSize:`${20*Math.max(t,.7)}px`})}
