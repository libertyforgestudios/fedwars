(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const p of a.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function s(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=s(r);fetch(r.href,a)}})();const H={type:Phaser.AUTO,width:window.innerWidth,height:window.innerHeight,parent:"game-container",scale:{mode:Phaser.Scale.RESIZE,autoCenter:Phaser.Scale.CENTER_BOTH},scene:{preload:Q,create:ee,update:te},physics:{default:"arcade",arcade:{gravity:{y:0}}}};let m,n,f,M,k,D,d,F,A,E,b,Y,X,g=0,c=1,l,L,e,y=0,x=0,w=0,C=0,O=!1;const V=document.getElementById("start-screen"),I=document.getElementById("instructions-screen"),R=document.getElementById("score-screen"),K=document.getElementById("sentinelMode"),U=document.getElementById("dogeMode"),Z=document.getElementById("instructions-text"),_=document.getElementById("startButton"),j=document.getElementById("score-title"),J=document.getElementById("score-details"),$=document.getElementById("orientationOverlay");N()?(B(),window.addEventListener("resize",B),window.addEventListener("orientationchange",B)):$.style.display="none";K.addEventListener("click",()=>G("sentinel"));U.addEventListener("click",()=>G("doge"));function G(t){n=t,V.style.display="none",I.style.display="flex",I.style.backgroundImage=n==="sentinel"?"url('/assets/sentinel-bg.png')":"url('/assets/doge-bg.png')",Z.textContent=n==="sentinel"?"You’re a loyal agent protecting a vital cause! Drag field logs, briefs, and ledgers to the shredder before auditors strike. Drag decoy reports (green) to the printer to mislead them. Fail, and it’s Audit Bust!":"You’re a whistleblower fighting to expose corruption! Drag expense reports, emails, and ledgers to the scanner to build your case. Drag testimony (green) to the printer to gain support. Fail, and trust is lost!",_.onclick=()=>{I.style.display="none",m=new Phaser.Game(H),document.querySelector("canvas").style.display="block",O=!0,B()}}function Q(){this.load.image("sentinel-bg","/assets/sentinel-bg.png"),this.load.image("doge-bg","/assets/doge-bg.png"),this.load.image("field-expense-logs","/assets/field-expense-logs.png"),this.load.image("operation-briefs","/assets/operation-briefs.png"),this.load.image("project-ledgers","/assets/project-ledgers.png"),this.load.image("decoy-reports","/assets/decoy-reports.png"),this.load.image("expense-reports","/assets/expense-reports.png"),this.load.image("emails","/assets/emails.png"),this.load.image("ledgers","/assets/ledgers.png"),this.load.image("testimony","/assets/testimony.png"),this.load.image("shredder","/assets/shredder.png"),this.load.image("scanner","/assets/scanner.png"),this.load.image("printer","/assets/printer.png"),this.load.on("filecomplete",t=>console.log(`Loaded ${t}`)),this.load.on("loaderror",t=>console.error(`Failed to load ${t.key}`))}function ee(){e=Math.min(this.scale.width/1920,this.scale.height/1080),l=n==="sentinel"?0:100,g=0,c=1,y=0,x=0,w=0,C=0,X=this.add.image(0,0,n==="sentinel"?"sentinel-bg":"doge-bg").setOrigin(0,0).setDisplaySize(this.scale.width,this.scale.height).setDepth(0),Y=this.add.rectangle(this.scale.width/2,45*e,this.scale.width,90*e,0,.8).setOrigin(.5,.5).setDepth(1),M=this.add.image(this.scale.width/2,this.scale.height-100*e,"shredder").setInteractive().setScale(e*1.5).setDepth(2),k=this.add.image(this.scale.width/2,this.scale.height-100*e,"scanner").setInteractive().setScale(e*1.5).setDepth(2),D=this.add.image(this.scale.width-100*e,this.scale.height-100*e,"printer").setInteractive().setScale(e*1.5).setDepth(2),M.visible=n==="sentinel",k.visible=n==="doge",D.visible=!0;const t=this.scale.width/2-100*e;F=this.add.rectangle(this.scale.width/2,90*e,t,20*e).setStrokeStyle(2,16777215).setOrigin(.5,0).setDepth(2),d=this.add.rectangle((this.scale.width-t)/2,90*e,t,20*e,65280).setOrigin(0,0).setDepth(2),A=this.add.text(this.scale.width/2,20*e,n==="sentinel"?"Auditor's Suspicion":"Public Trust",{fontSize:`${20*Math.max(e,.7)}px`,color:"#fff",align:"center"}).setOrigin(.5,0).setDepth(2),T(this,0),E=this.add.text(this.scale.width-50*e,40,`Score: ${g}`,{fontSize:`${20*Math.max(e,.7)}px`,color:"#fff",align:"right"}).setOrigin(1,.5).setDepth(2),b=this.add.text(this.scale.width-50*e,70,`x${c}`,{fontSize:`${20*Math.max(e,.7)}px`,color:"#fff",align:"right"}).setOrigin(1,.5).setDepth(2),f=this.physics.add.group({depth:10}),this.input.on("drag",(i,s,o,r)=>{const a=50*e,p=this.scale.width-50*e,v=50*e,S=this.scale.height-50*e;s.x=Phaser.Math.Clamp(o,a,p),s.y=Phaser.Math.Clamp(r,v,S),s.timerCircle&&(s.timerCircle.x=s.x,s.timerCircle.y=s.y-60*e)}),this.input.on("dragend",(i,s)=>se(this,i,s)),L=this.time.addEvent({delay:800,callback:ie,callbackScope:this,loop:!0}),this.time.addEvent({delay:1e3,callback:oe,callbackScope:this,loop:!0}),this.scale.on("resize",le,this)}function te(){f&&f.children&&f.children.each(t=>{if(t.timer!==void 0&&(t.timer-=this.game.loop.delta/1e3,re(t),t.timer<=0)){if(t.timerCircle.destroy(),t.destroy(),!t.getData("isBeneficial")){let i;switch(t.texture.key){case(n==="sentinel"?"field-expense-logs":"expense-reports"):i=n==="sentinel"?1:-1;break;case(n==="sentinel"?"operation-briefs":"emails"):i=n==="sentinel"?10:-10;break;case(n==="sentinel"?"project-ledgers":"ledgers"):i=n==="sentinel"?20:-20;break}T(this,i)}c=1,b.setText(`x${c}`)}})}function se(t,i,s){if(!s||s.timer===void 0||s.timer<=0)return;const o=n==="sentinel"?M:k,r=D;s.getData("isBeneficial")?Phaser.Geom.Intersects.RectangleToRectangle(s.getBounds(),r.getBounds())&&(s.timerCircle.destroy(),s.timer=void 0,g+=s.getData("points")*c,E.setText(`Score: ${g}`),T(t,n==="sentinel"?-25:25),c=Math.min(c+1,5),b.setText(`x${c}`),C++,s.destroy()):Phaser.Geom.Intersects.RectangleToRectangle(s.getBounds(),o.getBounds())&&(s.timerCircle.destroy(),s.timer=void 0,g+=s.getData("points")*c,E.setText(`Score: ${g}`),T(t,0),c=Math.min(c+1,5),b.setText(`x${c}`),s.texture.key===(n==="sentinel"?"field-expense-logs":"expense-reports")?y++:s.texture.key===(n==="sentinel"?"operation-briefs":"emails")?x++:s.texture.key===(n==="sentinel"?"project-ledgers":"ledgers")&&w++,s.destroy())}function ie(){const t=100*e,i=this.scale.width-100*e,s=150*e,o=this.scale.height/2,r=Phaser.Math.Between(t,i),a=Phaser.Math.Between(s,o),p=n==="sentinel"?[{key:"field-expense-logs",points:10,meterChange:1,weight:50},{key:"operation-briefs",points:20,meterChange:10,weight:30},{key:"project-ledgers",points:50,meterChange:20,weight:20}]:[{key:"expense-reports",points:10,meterChange:1,weight:50},{key:"emails",points:20,meterChange:10,weight:30},{key:"ledgers",points:50,meterChange:20,weight:20}],v=n==="sentinel"&&l>30||n==="doge"&&l<70;let S=[...p];v&&S.push({key:n==="sentinel"?"decoy-reports":"testimony",points:100,meterChange:25,weight:10});const W=S.reduce((P,q)=>P+q.weight,0);let z=Math.random()*W,u;for(const P of S)if(z-=P.weight,z<=0){u=P;break}const h=f.create(r,a,u.key).setInteractive({draggable:!0}).setScale(e*1.5).setDepth(10).setData("points",u.points).setData("meterChange",u.meterChange).setData("isBeneficial",u.key==="decoy-reports"||u.key==="testimony");h.timer=3,h.timerCircle=ne(this,h.x,h.y-60*e),h.originalX=h.x,h.originalY=h.y}function ne(t,i,s){return t.add.graphics({x:i,y:s}).setDepth(10)}function re(t){if(!t.timerCircle)return;const i=t.timer/3;t.timerCircle.clear(),t.timerCircle.lineStyle(8*e,16777215),t.timerCircle.beginPath(),t.timerCircle.arc(0,0,20*e,-Math.PI/2,2*Math.PI*i-Math.PI/2,!1),t.timerCircle.strokePath()}function T(t,i=0){l=l+i,l=Phaser.Math.Clamp(l,0,100),d.scaleX=l/100,n==="sentinel"?l<=25?d.fillColor=65280:l<=50?d.fillColor=16776960:l<=75?d.fillColor=16753920:d.fillColor=16711680:l>75?d.fillColor=65280:l>50?d.fillColor=16776960:l>25?d.fillColor=16753920:d.fillColor=16711680,l===(n==="sentinel"?100:0)&&ae(t)}function oe(t){L.delay=Math.max(L.delay-8,300)}function ae(t){t.time.removeAllEvents(),f.children.each(o=>{o.timerCircle&&o.timerCircle.destroy()}),f.clear(!0),document.querySelector("canvas").style.display="none",R.style.display="flex",R.style.backgroundImage="url('/assets/summary-bg.png')",O=!1,j.textContent=n==="sentinel"?"Audit Bust!":"Trust Lost!";const i=n==="sentinel"?"Shredded":"Scanned",s=n==="sentinel"?"Decoy Reports":"Testimonies";J.innerHTML=`
    <p>${i} ${n==="sentinel"?"Field Expense Logs":"Expense Reports"}: ${y} (${y*10} pts)</p>
    <p>${i} ${n==="sentinel"?"Operation Briefs":"Emails"}: ${x} (${x*20} pts)</p>
    <p>${i} ${n==="sentinel"?"Project Ledgers":"Ledgers"}: ${w} (${w*50} pts)</p>
    <p>Printed ${s}: ${C} (${C*100} pts)</p>
    <p>Base Total: ${y*10+x*20+w*50+C*100} pts</p>
    <p>Multiplier Bonus: ${g-(y*10+x*20+w*50+C*100)} pts</p>
    <p>Final Score: ${g}</p>
  `,t.game.destroy(!0)}function N(){return/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)}function B(){if(!N()){$.style.display="none";return}window.matchMedia("(orientation: portrait)").matches?($.style.display="flex",m&&m.scene&&m.scene.pause("default")):($.style.display="none",O&&m&&m.scene&&m.scene.resume("default"))}function le(t){const i=t.width,s=t.height;e=Math.min(i/1920,s/1080),X.setDisplaySize(i,s),Y.setPosition(i/2,45*e).setSize(i,90*e),M.setPosition(i/2,s-100*e).setScale(e*1.5),k.setPosition(i/2,s-100*e).setScale(e*1.5),D.setPosition(i-100*e,s-100*e).setScale(e*1.5);const o=i/2-100*e;F.setPosition(i/2,90*e).setSize(o,20*e),d.setPosition((i-o)/2,90*e).setSize(o,20*e),A.setPosition(i/2,20*e).setStyle({fontSize:`${20*Math.max(e,.7)}px`}),E.setPosition(i-50*e,40).setStyle({fontSize:`${20*Math.max(e,.7)}px`}),b.setPosition(i-50*e,70).setStyle({fontSize:`${20*Math.max(e,.7)}px`})}
